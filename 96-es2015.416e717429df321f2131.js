(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{RmqX:function(t,e,n){"use strict";n.r(e),n.d(e,"SearchModule",(function(){return z}));var o=n("2qjx"),r=n("co2y"),i=n("2Vo4"),c=n("fXoL");let s=(()=>{class t{constructor(t){this._productsService=t,this._filters={},this._sortType=r.a,this.countBy$=t=>this._productsService.countBy$(t),this._productsSubject$=new i.a([]),this.products$=this._productsSubject$.asObservable()}set sortType(t){this._sortType=t,this._productsService.getBy$(this._filters,this._sortType).subscribe(t=>this._productsSubject$.next(t))}set filters(t){this._filters=t,this._productsService.getBy$(this._filters,this._sortType).subscribe(t=>this._productsSubject$.next(t))}}return t.\u0275fac=function(e){return new(e||t)(c.Ub(o.a))},t.\u0275prov=c.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var a=n("PCNd"),l=n("ofXK"),b=n("tyNb"),u=n("mrSG"),p=n("hKYS"),g=n("U5Sr"),d=n("azmC"),h=n("TEn/"),f=n("ajRT");function _(t,e){if(1&t){const t=c.Rb();c.Qb(0,"ion-item"),c.Qb(1,"ion-label",3),c.Yb("click",(function(){c.mc(t);const n=e.$implicit;return c.ac(2).closeSelf(n.value)})),c.sc(2),c.Pb(),c.Pb()}if(2&t){const t=e.$implicit;c.zb(2),c.tc(t.label)}}function C(t,e){if(1&t&&(c.Ob(0),c.Qb(1,"ion-item-divider"),c.Qb(2,"ion-label"),c.sc(3),c.Pb(),c.Pb(),c.qc(4,_,3,1,"ion-item",2),c.Nb()),2&t){const t=e.$implicit;c.zb(3),c.tc(t.groupLabel),c.zb(1),c.gc("ngForOf",t.values)}}let P=(()=>{class t{constructor(t,e){this._sortTypesService=t,this._modalController=e,this.closeSelf=(t=null)=>this._modalController.dismiss(t)}get sortTypes(){return this._sortTypesService.sortTypes}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(d.a),c.Lb(h.D))},t.\u0275cmp=c.Fb({type:t,selectors:[["app-sort-by"]],decls:6,vars:1,consts:[["headerTitle","Sortuj wedlug","cancelBtnName","Cofnij",3,"cancel"],["lines","none"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,e){1&t&&(c.Qb(0,"app-modal",0),c.Yb("cancel",(function(){return e.closeSelf()})),c.Qb(1,"ion-list",1),c.Qb(2,"ion-list-header"),c.Qb(3,"h3"),c.sc(4,"Sortuj wed\u0142ug"),c.Pb(),c.Pb(),c.qc(5,C,5,2,"ng-container",2),c.Pb(),c.Pb()),2&t&&(c.zb(5),c.gc("ngForOf",e.sortTypes))},directives:[f.a,h.q,h.r,l.j,h.o,h.p,h.n],styles:["ion-list[_ngcontent-%COMP%]{padding:0!important}ion-list[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{--ion-background-color:#e9ecf0!important;color:#000}ion-footer[_ngcontent-%COMP%]{padding:10px}"]}),t})(),y=(()=>{class t{constructor(t,e){this._searchService=t,this._modalController=e,this.filters={},this.applyFilters=()=>{},this.closeSelf=()=>this._modalController.dismiss({dismissed:!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(s),c.Lb(h.D))},t.\u0275cmp=c.Fb({type:t,selectors:[["app-filters"]],decls:1,vars:1,consts:[["headerTitle","Filtruj","cancelBtnName","Cofnij",3,"applyBtnName","cancel"]],template:function(t,e){1&t&&(c.Qb(0,"app-modal",0),c.Yb("cancel",(function(){return e.closeSelf()})),c.Pb()),2&t&&c.gc("applyBtnName","Filtruj (0)")},directives:[f.a],styles:["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:10px}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{background-color:transparent;padding:10px;font-size:larger}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:larger}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%]{top:0;right:0;position:absolute}ion-content[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]{bottom:0;position:fixed}"]}),t})();var m=n("DnKK"),O=n("+Efk"),v=n("ioEP");const M=["searchbar"],S=function(){return["/zakladki/szukaj"]},T=function(t){return{selectedCategory:t}};function Q(t,e){if(1&t&&(c.Qb(0,"a",8),c.Qb(1,"ion-item"),c.sc(2),c.Pb(),c.Pb()),2&t){const t=e.$implicit;c.gc("routerLink",c.ic(3,S))("queryParams",c.jc(4,T,t.value)),c.zb(2),c.uc(" ",t.label," ")}}function k(t,e){if(1&t){const t=c.Rb();c.Ob(0),c.Qb(1,"ion-header",2),c.Qb(2,"ion-searchbar",3,4),c.Yb("ionChange",(function(e){return c.mc(t),c.ac().searchForCategory(e.target.value)}))("ionClear",(function(){return c.mc(t),c.ac().clearProposedCategories()})),c.Pb(),c.Pb(),c.Qb(4,"ion-content"),c.Qb(5,"ion-list",5),c.qc(6,Q,3,6,"a",6),c.Pb(),c.Pb(),c.Qb(7,"ion-footer",7),c.Qb(8,"ion-toolbar"),c.Mb(9,"app-categories-bar"),c.Pb(),c.Pb(),c.Nb()}if(2&t){const t=c.ac();c.zb(6),c.gc("ngForOf",t.proposedCategories)}}function j(t,e){if(1&t&&c.Mb(0,"app-products-section",15),2&t){const t=c.ac(2);c.gc("title","Produkty z kategorii: "+t.actualCategoryTree.label)("products",t.products)}}function F(t,e){if(1&t){const t=c.Rb();c.Qb(0,"ion-header"),c.Qb(1,"ion-toolbar"),c.Qb(2,"ion-row"),c.Qb(3,"ion-col"),c.Qb(4,"button",9),c.Qb(5,"a",10),c.Yb("click",(function(){return c.mc(t),c.ac().openCategories()})),c.sc(6,"Kategorie"),c.Pb(),c.Pb(),c.Pb(),c.Qb(7,"ion-col"),c.Qb(8,"button",11),c.Yb("click",(function(){return c.mc(t),c.ac().openFilters()})),c.Qb(9,"a",12),c.sc(10,"Filtry"),c.Pb(),c.Pb(),c.Pb(),c.Qb(11,"ion-col"),c.Qb(12,"button",11),c.Yb("click",(function(){return c.mc(t),c.ac().openSortBy()})),c.Qb(13,"a",12),c.sc(14,"Sortuj"),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Qb(15,"ion-content",13),c.qc(16,j,1,2,"app-products-section",14),c.Pb()}if(2&t){const t=c.ac();c.zb(16),c.gc("ngIf",!!t.products&&t.products.length>0)}}const B=[{path:"",component:(()=>{class t{constructor(t,e,n,o){this._searchService=t,this._categoriesService=e,this._modalController=n,this._activatedRoute=o,this.actualCategoryTree={ID:"",label:"test",value:"test"},this.proposedCategories=[],this.ionViewDidEnter=()=>setTimeout(()=>{this.searchbar&&this.searchbar.setFocus()}),this.clearProposedCategories=()=>this.proposedCategories=[]}ngOnInit(){this._searchService.products$.pipe(Object(m.a)(this)).subscribe(t=>this.products=t),this._activatedRoute.paramMap.pipe(Object(m.a)(this)).subscribe(t=>{this._updateFiltersBy(t),this._updateSortTypeBy(t)})}get categoriesTrees(){return this._categoriesService.categoriesTrees}searchForCategory(t){t&&""!==t.trim()?this.proposedCategories=this._categoriesService.getCategoriesBy(t):this.clearProposedCategories()}openFilters(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:y});return yield t.present()}))}openCategories(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:p.a,componentProps:{actualCategoryTree:this.parentCategoryTree,categories:this.categoriesTrees}});return yield t.present()}))}openSortBy(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:P});return t.onDidDismiss().then(t=>t.data?this._searchService.sortType=t.data:null),yield t.present()}))}ngOnDestroy(){}_updateSortTypeBy(t){const e=t.get("sortType")?t.get("sortType"):r.a;this._searchService.sortType=e}_updateFiltersBy(t){const e=t.get("filters")?JSON.parse(t.get("filters")):{};this._searchService.filters=e,e.category&&this._updateCategoryBy(e.category)}_updateCategoryBy(t){const e=this._categoriesService.findParentCategoryTreeBy(t),n=this._categoriesService.findCategoryTreeBy(t);this.parentCategoryTree=e||n,this.actualCategoryTree=e?n:null}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(s),c.Lb(g.a),c.Lb(h.D),c.Lb(b.a))},t.\u0275cmp=c.Fb({type:t,selectors:[["app-search"]],viewQuery:function(t,e){var n;1&t&&c.wc(M,!0),2&t&&c.kc(n=c.Zb())&&(e.searchbar=n.first)},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["filterSearch",""],["no-border",""],["autocomplete","on","autocorrect","on","inputmode","text","placeholder","Jakiego produktu szukasz?","spellcheck","true","debounce","500",3,"ionChange","ionClear"],["searchbar",""],["lines","none"],[3,"routerLink","queryParams",4,"ngFor","ngForOf"],["no-border","","transparent",""],[3,"routerLink","queryParams"],[1,"header-btn"],["href","javascript:void(0)",3,"click"],[1,"header-btn",3,"click"],["href","javascript:void(0)"],["fullscreen",""],[3,"title","products",4,"ngIf"],[3,"title","products"]],template:function(t,e){if(1&t&&(c.qc(0,k,10,1,"ng-container",0),c.qc(1,F,17,1,"ng-template",null,1,c.rc)),2&t){const t=c.lc(2);c.gc("ngIf",!e.actualCategoryTree)("ngIfElse",t)}},directives:[l.k,h.l,h.u,h.G,h.h,h.q,l.j,h.k,h.A,O.a,b.i,h.F,h.n,h.t,h.g,v.a],styles:["ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]{background-color:transparent}ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:larger}ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:large}ion-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{color:green}"]}),t})()}];let w=(()=>{class t{}return t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({factory:function(e){return new(e||t)},imports:[[b.j.forChild(B)],b.j]}),t})(),z=(()=>{class t{}return t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({factory:function(e){return new(e||t)},providers:[s],imports:[[h.B,l.b,w,a.a]]}),t})()}}]);