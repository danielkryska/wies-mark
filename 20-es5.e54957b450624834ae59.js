function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{TdLt:function(e,n,t){"use strict";t.r(n),t.d(n,"MessagesModule",(function(){return C}));var s=t("PCNd"),r=t("TEn/"),o=t("mrSG"),a=t("N7YL"),i=t("ZjcB"),c=t("fXoL"),u=t("tyNb"),l=t("ofXK");function b(e,n){if(1&e&&(c.Qb(0,"p"),c.Qb(1,"small"),c.sc(2),c.bc(3,"date"),c.Pb(),c.Pb()),2&e){var t=c.ac().$implicit,s=c.ac();c.zb(2),c.uc(" Ostatnia wiadomosc z: ",c.dc(3,1,s.lastMessageTimeInMs(t),"M/d/yy, hh:mm:ss")," ")}}var f=function(e){return{"no-messages":e}};function m(e,n){if(1&e){var t=c.Rb();c.Qb(0,"ion-item",3),c.Yb("click",(function(){c.nc(t);var e=n.$implicit;return c.ac().openMessage(e)})),c.Qb(1,"ion-badge",4),c.sc(2),c.Pb(),c.Qb(3,"ion-label"),c.Qb(4,"span"),c.Qb(5,"b"),c.sc(6),c.Pb(),c.Pb(),c.qc(7,b,4,4,"p",5),c.Qb(8,"p"),c.Qb(9,"small"),c.Qb(10,"b"),c.sc(11),c.Pb(),c.Pb(),c.Pb(),c.Pb(),c.Pb()}if(2&e){var s=n.$implicit,r=c.ac();c.zb(1),c.ic("color",0===r.unreadCount(s)?"":"success"),c.hc("ngClass",c.kc(6,f,0===r.unreadCount(s))),c.zb(1),c.uc(" ",r.unreadCount(s)>9?"+9":r.unreadCount(s)," "),c.zb(4),c.tc(s.user.name),c.zb(1),c.hc("ngIf",r.lastMessage(s).creationDate),c.zb(4),c.uc(" ",r.lastMessage(s).content," ")}}var p,g,d,h=[{path:"",component:(p=function(){function e(n,t,s){var r=this;_classCallCheck(this,e),this._messagesService=n,this._modalController=t,this._router=s,this.lastMessage=function(e){return!!e.messages[e.messages.length-1]&&e.messages[e.messages.length-1]},this.lastMessageTimeInMs=function(e){return 1e3*r.lastMessage(e).creationDate},this.unreadCount=function(e){return e.messages.filter((function(e){return!e.readDate&&e.isResponse})).length},this.openMessage=function(e){return Object(o.a)(r,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._modalController.create({component:i.a,componentProps:{conversation:e}});case 2:return t=n.sent,e.messages.filter((function(e){return!e.readDate})).forEach((function(e){return e.readDate=(new Date).getTime()})),n.next=6,t.present();case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n,this)})))}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this._router.events.subscribe((function(){"/zakladki/wiadomosci"===e._router.url&&e.conversations.filter((function(e){return!e.viewDate})).forEach((function(e){return e.viewDate=(new Date).getTime()}))}))}},{key:"conversations",get:function(){return this._messagesService.conversations}}]),e}(),p.\u0275fac=function(e){return new(e||p)(c.Lb(a.a),c.Lb(r.M),c.Lb(u.g))},p.\u0275cmp=c.Fb({type:p,selectors:[["ng-component"]],decls:7,vars:1,consts:[["fullScreen",""],["lines","none",1,"conversations-list"],["class","conversation",3,"click",4,"ngFor","ngForOf"],[1,"conversation",3,"click"],["slot","start",3,"ngClass","color"],[4,"ngIf"]],template:function(e,n){1&e&&(c.Qb(0,"ion-header"),c.Qb(1,"ion-toolbar"),c.Qb(2,"ion-title"),c.sc(3,"Moje wiadomo\u015bci"),c.Pb(),c.Pb(),c.Pb(),c.Qb(4,"ion-content",0),c.Qb(5,"ion-list",1),c.qc(6,m,12,8,"ion-item",2),c.Pb(),c.Pb()),2&e&&(c.zb(6),c.hc("ngForOf",n.conversations))},directives:[r.m,r.J,r.H,r.k,r.t,l.l,r.q,r.f,l.k,r.s,l.m],pipes:[l.e],encapsulation:2}),p)}],v=((d=function e(){_classCallCheck(this,e)}).\u0275mod=c.Jb({type:d}),d.\u0275inj=c.Ib({factory:function(e){return new(e||d)},imports:[[u.j.forChild(h)],u.j]}),d),C=((g=function e(){_classCallCheck(this,e)}).\u0275mod=c.Jb({type:g}),g.\u0275inj=c.Ib({factory:function(e){return new(e||g)},imports:[[l.b,r.K,v,s.a]]}),g)}}]);