(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{RmqX:function(t,e,o){"use strict";o.r(e),o.d(e,"SearchModule",(function(){return $}));var n=o("2qjx"),r=o("co2y"),i=o("2Vo4"),c=o("fXoL");let s=(()=>{class t{constructor(t){this._productsService=t,this._filters={},this._sortType=r.a,this.countBy$=t=>this._productsService.countBy$(t),this._productsSubject$=new i.a([]),this.products$=this._productsSubject$.asObservable()}set sortType(t){this._sortType=t,this._productsService.getBy$(this._filters,this._sortType).subscribe(t=>this._productsSubject$.next(t))}set filters(t){this._filters=t,this._productsService.getBy$(this._filters,this._sortType).subscribe(t=>this._productsSubject$.next(t))}}return t.\u0275fac=function(e){return new(e||t)(c.Tb(n.a))},t.\u0275prov=c.Gb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var a=o("PCNd"),l=o("ofXK"),b=o("tyNb"),u=o("mrSG"),p=o("hKYS"),d=o("U5Sr"),g=o("azmC"),h=o("TEn/"),f=o("ajRT");function _(t,e){if(1&t){const t=c.Qb();c.Pb(0,"ion-item"),c.Pb(1,"ion-label",3),c.Xb("click",(function(){c.lc(t);const o=e.$implicit;return c.Zb(2).closeSelf(o.value)})),c.qc(2),c.Ob(),c.Ob()}if(2&t){const t=e.$implicit;c.zb(2),c.rc(t.label)}}function O(t,e){if(1&t&&(c.Nb(0),c.Pb(1,"ion-item-divider"),c.Pb(2,"ion-label"),c.qc(3),c.Ob(),c.Ob(),c.oc(4,_,3,1,"ion-item",2),c.Mb()),2&t){const t=e.$implicit;c.zb(3),c.rc(t.groupLabel),c.zb(1),c.fc("ngForOf",t.values)}}let C=(()=>{class t{constructor(t,e){this._sortTypesService=t,this._modalController=e,this.closeSelf=(t=null)=>this._modalController.dismiss(t)}get sortTypes(){return this._sortTypesService.sortTypes}}return t.\u0275fac=function(e){return new(e||t)(c.Kb(g.a),c.Kb(h.A))},t.\u0275cmp=c.Eb({type:t,selectors:[["app-sort-by"]],decls:6,vars:1,consts:[["headerTitle","Sortuj wedlug","cancelBtnName","Cofnij",3,"cancel"],["lines","none"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,e){1&t&&(c.Pb(0,"app-modal",0),c.Xb("cancel",(function(){return e.closeSelf()})),c.Pb(1,"ion-list",1),c.Pb(2,"ion-list-header"),c.Pb(3,"h3"),c.qc(4,"Sortuj wed\u0142ug"),c.Ob(),c.Ob(),c.oc(5,O,5,2,"ng-container",2),c.Ob(),c.Ob()),2&t&&(c.zb(5),c.fc("ngForOf",e.sortTypes))},directives:[f.a,h.o,h.p,l.i,h.m,h.n,h.l],styles:["ion-list[_ngcontent-%COMP%]{padding:0!important}ion-list[_ngcontent-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{--ion-background-color:#e9ecf0!important;color:#000}ion-footer[_ngcontent-%COMP%]{padding:10px}"]}),t})(),y=(()=>{class t{constructor(t,e){this._searchService=t,this._modalController=e,this.filters={},this.applyFilters=()=>{},this.closeSelf=()=>this._modalController.dismiss({dismissed:!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Kb(s),c.Kb(h.A))},t.\u0275cmp=c.Eb({type:t,selectors:[["app-filters"]],decls:1,vars:1,consts:[["headerTitle","Filtruj","cancelBtnName","Cofnij",3,"applyBtnName","cancel"]],template:function(t,e){1&t&&(c.Pb(0,"app-modal",0),c.Xb("cancel",(function(){return e.closeSelf()})),c.Ob()),2&t&&c.fc("applyBtnName","Filtruj (0)")},directives:[f.a],styles:["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:10px}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{background-color:transparent;padding:10px;font-size:larger}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:larger}ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .close-self-btn[_ngcontent-%COMP%]{top:0;right:0;position:absolute}ion-content[_ngcontent-%COMP%]   ion-footer[_ngcontent-%COMP%]{bottom:0;position:fixed}"]}),t})();var P=o("DnKK"),m=o("+Efk"),v=o("ioEP");const M=["searchbar"],S=function(){return["/zakladki/szukaj"]},T=function(t){return{selectedCategory:t}};function j(t,e){if(1&t&&(c.Pb(0,"a",8),c.Pb(1,"ion-item"),c.qc(2),c.Ob(),c.Ob()),2&t){const t=e.$implicit;c.fc("routerLink",c.hc(3,S))("queryParams",c.ic(4,T,t.value)),c.zb(2),c.sc(" ",t.label," ")}}function k(t,e){if(1&t){const t=c.Qb();c.Nb(0),c.Pb(1,"ion-header",2),c.Pb(2,"ion-searchbar",3,4),c.Xb("ionChange",(function(e){return c.lc(t),c.Zb().searchForCategory(e.target.value)}))("ionClear",(function(){return c.lc(t),c.Zb().clearProposedCategories()})),c.Ob(),c.Ob(),c.Pb(4,"ion-content"),c.Pb(5,"ion-list",5),c.oc(6,j,3,6,"a",6),c.Ob(),c.Ob(),c.Pb(7,"ion-footer",7),c.Pb(8,"ion-toolbar"),c.Lb(9,"app-categories-bar"),c.Ob(),c.Ob(),c.Mb()}if(2&t){const t=c.Zb();c.zb(6),c.fc("ngForOf",t.proposedCategories)}}function B(t,e){if(1&t&&c.Lb(0,"app-products-section",15),2&t){const t=c.Zb(2);c.fc("title","Produkty z kategorii: "+t.actualCategoryTree.label)("products",t.products)}}function w(t,e){if(1&t){const t=c.Qb();c.Pb(0,"ion-header"),c.Pb(1,"ion-toolbar"),c.Pb(2,"ion-row"),c.Pb(3,"ion-col"),c.Pb(4,"button",9),c.Pb(5,"a",10),c.Xb("click",(function(){return c.lc(t),c.Zb().openCategories()})),c.qc(6,"Kategorie"),c.Ob(),c.Ob(),c.Ob(),c.Pb(7,"ion-col"),c.Pb(8,"button",11),c.Xb("click",(function(){return c.lc(t),c.Zb().openFilters()})),c.Pb(9,"a",12),c.qc(10,"Filtry"),c.Ob(),c.Ob(),c.Ob(),c.Pb(11,"ion-col"),c.Pb(12,"button",11),c.Xb("click",(function(){return c.lc(t),c.Zb().openSortBy()})),c.Pb(13,"a",12),c.qc(14,"Sortuj"),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Ob(),c.Pb(15,"ion-content",13),c.oc(16,B,1,2,"app-products-section",14),c.Ob()}if(2&t){const t=c.Zb();c.zb(16),c.fc("ngIf",!!t.products&&t.products.length>0)}}const F=[{path:"",component:(()=>{class t{constructor(t,e,o,n){this._searchService=t,this._categoriesService=e,this._modalController=o,this._activatedRoute=n,this.actualCategoryTree={ID:"",label:"test",value:"test"},this.proposedCategories=[],this.ionViewDidEnter=()=>setTimeout(()=>{this.searchbar&&this.searchbar.setFocus()}),this.clearProposedCategories=()=>this.proposedCategories=[]}ngOnInit(){this._searchService.products$.pipe(Object(P.a)(this)).subscribe(t=>this.products=t),this._activatedRoute.paramMap.pipe(Object(P.a)(this)).subscribe(t=>{this._updateFiltersBy(t),this._updateSortTypeBy(t)})}get categoriesTrees(){return this._categoriesService.categoriesTrees}searchForCategory(t){t&&""!==t.trim()?this.proposedCategories=this._categoriesService.getCategoriesBy(t):this.clearProposedCategories()}openFilters(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:y});return yield t.present()}))}openCategories(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:p.a,componentProps:{actualCategoryTree:this.parentCategoryTree,categories:this.categoriesTrees}});return yield t.present()}))}openSortBy(){return Object(u.a)(this,void 0,void 0,(function*(){const t=yield this._modalController.create({component:C});return t.onDidDismiss().then(t=>t?this._searchService.sortType=t.data:null),yield t.present()}))}ngOnDestroy(){}_updateSortTypeBy(t){const e=t.get("sortType")?t.get("sortType"):r.a;this._searchService.sortType=e}_updateFiltersBy(t){const e=t.get("filters")?JSON.parse(t.get("filters")):{};this._searchService.filters=e,e.category&&this._updateCategoryBy(e.category)}_updateCategoryBy(t){const e=this._categoriesService.findParentCategoryTreeBy(t),o=this._categoriesService.findCategoryTreeBy(t);this.parentCategoryTree=e||o,this.actualCategoryTree=e?o:null}}return t.\u0275fac=function(e){return new(e||t)(c.Kb(s),c.Kb(d.a),c.Kb(h.A),c.Kb(b.a))},t.\u0275cmp=c.Eb({type:t,selectors:[["app-search"]],viewQuery:function(t,e){var o;1&t&&c.uc(M,!0),2&t&&c.jc(o=c.Yb())&&(e.searchbar=o.first)},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["filterSearch",""],["no-border",""],["autocomplete","on","autocorrect","on","inputmode","text","placeholder","Jakiego produktu szukasz?","spellcheck","true","debounce","500",3,"ionChange","ionClear"],["searchbar",""],["lines","none"],[3,"routerLink","queryParams",4,"ngFor","ngForOf"],["no-border","","transparent",""],[3,"routerLink","queryParams"],[1,"header-btn"],["href","javascript:void(0)",3,"click"],[1,"header-btn",3,"click"],["href","javascript:void(0)"],["fullscreen",""],[3,"title","products",4,"ngIf"],[3,"title","products"]],template:function(t,e){if(1&t&&(c.oc(0,k,10,1,"ng-container",0),c.oc(1,w,17,1,"ng-template",null,1,c.pc)),2&t){const t=c.kc(2);c.fc("ngIf",!e.actualCategoryTree)("ngIfElse",t)}},directives:[l.j,h.j,h.s,h.D,h.h,h.o,l.i,h.i,h.x,m.a,b.i,h.C,h.l,h.r,h.g,v.a],styles:["ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]{background-color:transparent}ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:larger}ion-toolbar[_ngcontent-%COMP%]   .header-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:large}ion-header[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{text-align:center}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{color:green}"]}),t})()}];let z=(()=>{class t{}return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(e){return new(e||t)},imports:[[b.j.forChild(F)],b.j]}),t})(),$=(()=>{class t{}return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(e){return new(e||t)},providers:[s],imports:[[h.y,l.b,z,a.a]]}),t})()}}]);