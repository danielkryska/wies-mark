(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{TdLt:function(e,s,t){"use strict";t.r(s),t.d(s,"MessagesModule",(function(){return f}));var n=t("PCNd"),o=t("TEn/"),i=t("mrSG"),c=t("N7YL"),a=t("ZjcB"),r=t("fXoL"),b=t("tyNb"),l=t("ofXK");function u(e,s){if(1&e&&(r.Qb(0,"p"),r.Qb(1,"small"),r.sc(2),r.bc(3,"date"),r.Pb(),r.Pb()),2&e){const e=r.ac().$implicit,s=r.ac();r.zb(2),r.uc(" Ostatnia wiadomosc z: ",r.dc(3,1,s.lastMessageTimeInMs(e),"M/d/yy, hh:mm:ss")," ")}}const m=function(e){return{"no-messages":e}};function g(e,s){if(1&e){const e=r.Rb();r.Qb(0,"ion-item",3),r.Yb("click",(function(){r.nc(e);const t=s.$implicit;return r.ac().openMessage(t)})),r.Qb(1,"ion-badge",4),r.sc(2),r.Pb(),r.Qb(3,"ion-label"),r.Qb(4,"span"),r.Qb(5,"b"),r.sc(6),r.Pb(),r.Pb(),r.qc(7,u,4,4,"p",5),r.Qb(8,"p"),r.Qb(9,"small"),r.Qb(10,"b"),r.sc(11),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()}if(2&e){const e=s.$implicit,t=r.ac();r.zb(1),r.ic("color",0===t.unreadCount(e)?"":"success"),r.hc("ngClass",r.kc(6,m,0===t.unreadCount(e))),r.zb(1),r.uc(" ",t.unreadCount(e)>9?"+9":t.unreadCount(e)," "),r.zb(4),r.tc(e.user.name),r.zb(1),r.hc("ngIf",t.lastMessage(e).creationDate),r.zb(4),r.uc(" ",t.lastMessage(e).content," ")}}const d=[{path:"",component:(()=>{class e{constructor(e,s,t){this._messagesService=e,this._modalController=s,this._router=t,this.lastMessage=e=>!!e.messages[e.messages.length-1]&&e.messages[e.messages.length-1],this.lastMessageTimeInMs=e=>1e3*this.lastMessage(e).creationDate,this.unreadCount=e=>e.messages.filter(e=>!e.readDate&&e.isResponse).length,this.openMessage=e=>Object(i.a)(this,void 0,void 0,(function*(){const s=yield this._modalController.create({component:a.a,componentProps:{conversation:e}});return e.messages.filter(e=>!e.readDate).forEach(e=>e.readDate=(new Date).getTime()),yield s.present()}))}get conversations(){return this._messagesService.conversations}ngOnInit(){this._router.events.subscribe(()=>{"/zakladki/wiadomosci"===this._router.url&&this.conversations.filter(e=>!e.viewDate).forEach(e=>e.viewDate=(new Date).getTime())})}}return e.\u0275fac=function(s){return new(s||e)(r.Lb(c.a),r.Lb(o.M),r.Lb(b.g))},e.\u0275cmp=r.Fb({type:e,selectors:[["ng-component"]],decls:7,vars:1,consts:[["fullScreen",""],["lines","none",1,"conversations-list"],["class","conversation",3,"click",4,"ngFor","ngForOf"],[1,"conversation",3,"click"],["slot","start",3,"ngClass","color"],[4,"ngIf"]],template:function(e,s){1&e&&(r.Qb(0,"ion-header"),r.Qb(1,"ion-toolbar"),r.Qb(2,"ion-title"),r.sc(3,"Moje wiadomo\u015bci"),r.Pb(),r.Pb(),r.Pb(),r.Qb(4,"ion-content",0),r.Qb(5,"ion-list",1),r.qc(6,g,12,8,"ion-item",2),r.Pb(),r.Pb()),2&e&&(r.zb(6),r.hc("ngForOf",s.conversations))},directives:[o.m,o.J,o.H,o.k,o.t,l.l,o.q,o.f,l.k,o.s,l.m],pipes:[l.e],encapsulation:2}),e})()}];let p=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(s){return new(s||e)},imports:[[b.j.forChild(d)],b.j]}),e})(),f=(()=>{class e{}return e.\u0275mod=r.Jb({type:e}),e.\u0275inj=r.Ib({factory:function(s){return new(s||e)},imports:[[l.b,o.K,p,n.a]]}),e})()}}]);